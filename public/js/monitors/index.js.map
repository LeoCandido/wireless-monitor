{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\r\n$(function () {\r\n    var $app = $('div#root-app');\r\n    var templates = {};\r\n\r\n    /**\r\n     * load template from cache or URL based on the type\r\n     * @param  {[type]} type [description]\r\n     * @return {[type]}      [description]\r\n     */\r\n    function loadTemplate(type) {\r\n        if (templates[type]) {\r\n            return templates[type];\r\n        }\r\n        return templates[type] = $.get('/templates/' + type + '/index.mustache')\r\n            .pipe(function (res) {\r\n                // compile and save to the cache\r\n                Mustache.parse(res)\r\n                return templates[type] = res;\r\n            });\r\n    }\r\n\r\n    var monitors = {\r\n        fetch: function (onSuccess, onComplete) {\r\n            $.ajax({\r\n                url: '/monitor/ajax-list',\r\n                success: function (json) {\r\n                    if (json.ok) {\r\n                        onSuccess(json.list);\r\n                    }\r\n                },\r\n                error: function (jqXHR, textStatus, errorThrown) {\r\n                    console.log(errorThrown);\r\n                },\r\n                complete: function () {\r\n                    onComplete();\r\n                }\r\n            });\r\n        },\r\n        render: function (list) {\r\n            list = list || [];\r\n            list.forEach(function (element, index) {\r\n                var promise = loadTemplate(element.data.type);\r\n                $.when(promise).done(function (res) {\r\n                    // order for flex-box\r\n                    element.order = index;\r\n                    var result = Mustache.render(res, element);\r\n                    $app.append(result);\r\n                }).fail(function () {\r\n                    console.warn('Template', element.data.type, 'not found.');\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    monitors.fetch(function (list) {\r\n        $app.html(''); // clear loading text\r\n        var result = monitors.render(list);\r\n    }, function () {\r\n        console.log('loaded.');\r\n    });\r\n});\r\n"]}